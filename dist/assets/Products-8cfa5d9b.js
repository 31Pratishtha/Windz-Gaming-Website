import{u as w,n as b,b as j,r as p,d as I,e as N,j as t,m as q,k as m,o as h,s as f,l as D}from"./index-15ab2af5.js";function S(){const{currentUser:c}=w(),{products:l}=b(),u=j(),[g,d]=p.useState({});let i=null;c&&(i=I(N,"Users",c.uid,"Cart")),p.useEffect(()=>{(async()=>{const a={};for(const o of l){const r=m(i,o.id);try{const s=(await h(r)).data();a[o.id]=(s==null?void 0:s.qty)||0}catch(n){console.log(n)}}d(a)})()},[l,c]);const y=async e=>{try{const a=e.id,o=m(i,a),r=await h(o),n=r.data();if(console.log("cartItemSnapshot: ",r.id),!r.exists())await f(o,{name:e.Name,image:e.Image,price:Number(e.Price),qty:1});else{const s=(n.qty||0)+1;await f(o,{...n,qty:s})}d(s=>({...s,[e.id]:(s[e.id]||0)+1}))}catch(a){console.log(a)}},x=async e=>{try{const a=e.id,o=m(i,a),n=(await h(o)).data();if(n.qty==1)await D(o);else if(n.qty>1){const s=(n.qty||0)-1;await f(o,{...n,qty:s})}d(s=>({...s,[e.id]:Math.max((s[e.id]||0)-1,0)}))}catch(a){console.log(a)}},v=()=>{u("/authentication",{replace:!0})};return t.jsx(q.div,{className:"text-myblack flex flex-col bg-slate-300 overflow-y-auto",initial:{opacity:0,transition:{duration:.3}},animate:{opacity:1},exit:{opacity:0,transition:{duration:.3}},children:t.jsxs("div",{className:"m-4",children:[console.log("I am re-rendering......"),l.map(e=>t.jsxs("div",{className:"grid md:grid-cols-4 md:grid-rows-1 sm:grid-cols-4 sm:grid-rows-3 gap-2 my-4 items-center bg-gradient-to-t from-slate-300 via-slate-200 to-slate-50 px-8 sm:py-8 md:px-20 py-2 rounded-lg",children:[t.jsx("img",{src:e.Image,width:150,height:150,alt:e.Name,loading:"lazy",className:"md:row-span-1 md:col-span-1 sm:row-span-3 sm:col-span-2 "}),t.jsx("h2",{className:"md:row-span-1 md:col-span-1 sm:row-span-1 sm:col-span-2 sm:flex sm:justify-center sm:text-center",children:e.Name}),t.jsxs("p",{className:"flex justify-center font-semibold md:row-span-1 md:col-span-1 sm:row-span-1 sm:col-span-2",children:["â‚¹",e.Price]}),c?g[e.id]>0?t.jsx("div",{className:"flex justify-center md:row-span-1 md:col-span-1 sm:row-span-1 sm:col-span-2",children:t.jsxs("div",{className:"grid grid-flow-col w-40 rounded-lg border border-solid border-slate-400  text-slate-800 ",children:[t.jsx("button",{onClick:()=>x(e),className:"px-[15%] py-2 bg-slate-800 text-mywhite rounded-s-lg hover:bg-gradient-to-b hover:from-[#065f46bd] hover:via-[#065f4689] hover:ease-in-out hover:scale-105 hover:duration-150 ",children:"-"}),t.jsx("p",{className:"text-center py-2",children:g[e.id]}),t.jsx("button",{onClick:()=>y(e),className:"px-[15%] py-2 bg-slate-800 text-mywhite rounded-e-lg hover:bg-gradient-to-b hover:from-[#065f46bd] hover:via-[#065f4689] hover:ease-in-out hover:scale-105 hover:duration-150 ",children:"+"})]})}):t.jsx("div",{className:"flex justify-center md:row-span-1 md:col-span-1 sm:row-span-1 sm:col-span-2",children:t.jsx("button",{onClick:()=>y(e),className:"bg-slate-800 text-mywhite py-2 w-40 rounded-lg hover:bg-gradient-to-b hover:from-[#065f46bd]  hover:via-[#065f4689] hover:ease-in-out hover:scale-105 hover:duration-150 ",children:"Add to cart"})}):t.jsx("div",{className:"flex justify-center md:row-span-1 md:col-span-1 sm:row-span-1 sm:col-span-2",children:t.jsx("button",{onClick:()=>v(),className:"bg-slate-800 text-mywhite py-2 w-40 rounded-lg hover:bg-gradient-to-b hover:from-[#065f46bd] hover:via-[#065f4689] hover:ease-in-out hover:scale-105 hover:duration-150 ",children:"Add to cart"})})]},e.id))]})})}export{S as default};
