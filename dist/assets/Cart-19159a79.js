import{P as l,R as f,a as pe,u as he,r as I,d as K,e as X,j as a,m as ve,F as Y,i as $,k as ye,l as xe,g as be}from"./index-15ab2af5.js";function Q(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(r,o).enumerable})),t.push.apply(t,n)}return t}function H(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Q(Object(t),!0).forEach(function(n){re(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Q(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function B(r){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?B=function(e){return typeof e}:B=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B(r)}function re(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function ge(r,e){return Ce(r)||je(r,e)||Se(r,e)||we()}function Ce(r){if(Array.isArray(r))return r}function je(r,e){var t=r&&(typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"]);if(t!=null){var n=[],o=!0,i=!1,d,v;try{for(t=t.call(r);!(o=(d=t.next()).done)&&(n.push(d.value),!(e&&n.length===e));o=!0);}catch(c){i=!0,v=c}finally{try{!o&&t.return!=null&&t.return()}finally{if(i)throw v}}return n}}function Se(r,e){if(r){if(typeof r=="string")return J(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return J(r,e)}}function J(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function we(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var y=function(e,t,n){var o=!!n,i=f.useRef(n);f.useEffect(function(){i.current=n},[n]),f.useEffect(function(){if(!o||!e)return function(){};var d=function(){i.current&&i.current.apply(i,arguments)};return e.on(t,d),function(){e.off(t,d)}},[o,t,e,i])},Ee=function(e){var t=f.useRef(e);return f.useEffect(function(){t.current=e},[e]),t.current},F=function(e){return e!==null&&B(e)==="object"},V="[object Object]",Ne=function r(e,t){if(!F(e)||!F(t))return e===t;var n=Array.isArray(e),o=Array.isArray(t);if(n!==o)return!1;var i=Object.prototype.toString.call(e)===V,d=Object.prototype.toString.call(t)===V;if(i!==d)return!1;if(!i&&!n)return e===t;var v=Object.keys(e),c=Object.keys(t);if(v.length!==c.length)return!1;for(var g={},C=0;C<v.length;C+=1)g[v[C]]=!0;for(var j=0;j<c.length;j+=1)g[c[j]]=!0;var x=Object.keys(g);if(x.length!==v.length)return!1;var N=e,O=t,k=function(u){return r(N[u],O[u])};return x.every(k)},ke=function(e,t,n){return F(e)?Object.keys(e).reduce(function(o,i){var d=!F(t)||!Ne(e[i],t[i]);return n.includes(i)?(d&&console.warn("Unsupported prop change: options.".concat(i," is not a mutable property.")),o):d?H(H({},o||{}),{},re({},i,e[i])):o},null):null},ne=f.createContext(null);ne.displayName="ElementsContext";var Oe=function(e,t){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e};l.any,l.object;l.func.isRequired;var ae=f.createContext(null);ae.displayName="CustomCheckoutSdkContext";var Ae=function(e,t){if(!e)throw new Error("Could not find CustomCheckoutProvider context; You need to wrap the part of your app that ".concat(t," in an <CustomCheckoutProvider> provider."));return e},Pe=f.createContext(null);Pe.displayName="CustomCheckoutContext";l.any,l.shape({clientSecret:l.string.isRequired,elementsOptions:l.object}).isRequired;var Z=function(e){var t=f.useContext(ae),n=f.useContext(ne);if(t&&n)throw new Error("You cannot wrap the part of your app that ".concat(e," in both <CustomCheckoutProvider> and <Elements> providers."));return t?Ae(t,e):Oe(n,e)},Re=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},m=function(e,t){var n="".concat(Re(e),"Element"),o=function(c){var g=c.id,C=c.className,j=c.options,x=j===void 0?{}:j,N=c.onBlur,O=c.onFocus,k=c.onReady,s=c.onChange,u=c.onEscape,A=c.onClick,M=c.onLoadError,S=c.onLoaderStart,E=c.onNetworksChange,ce=c.onConfirm,le=c.onCancel,ue=c.onShippingAddressChange,de=c.onShippingRateChange,q=Z("mounts <".concat(n,">")),L="elements"in q?q.elements:null,T="customCheckoutSdk"in q?q.customCheckoutSdk:null,fe=f.useState(null),G=ge(fe,2),h=G[0],me=G[1],w=f.useRef(null),W=f.useRef(null);y(h,"blur",N),y(h,"focus",O),y(h,"escape",u),y(h,"click",A),y(h,"loaderror",M),y(h,"loaderstart",S),y(h,"networkschange",E),y(h,"confirm",ce),y(h,"cancel",le),y(h,"shippingaddresschange",ue),y(h,"shippingratechange",de),y(h,"change",s);var _;k&&(e==="expressCheckout"?_=k:_=function(){k(h)}),y(h,"ready",_),f.useLayoutEffect(function(){if(w.current===null&&W.current!==null&&(L||T)){var b=null;T?b=T.createElement(e,x):L&&(b=L.create(e,x)),w.current=b,me(b),b&&b.mount(W.current)}},[L,T,x]);var z=Ee(x);return f.useEffect(function(){if(w.current){var b=ke(x,z,["paymentRequest"]);b&&w.current.update(b)}},[x,z]),f.useLayoutEffect(function(){return function(){if(w.current&&typeof w.current.destroy=="function")try{w.current.destroy(),w.current=null}catch{}}},[]),f.createElement("div",{id:g,className:C,ref:W})},i=function(c){Z("mounts <".concat(n,">"));var g=c.id,C=c.className;return f.createElement("div",{id:g,className:C})},d=t?i:o;return d.propTypes={id:l.string,className:l.string,onChange:l.func,onBlur:l.func,onFocus:l.func,onReady:l.func,onEscape:l.func,onClick:l.func,onLoadError:l.func,onLoaderStart:l.func,onNetworksChange:l.func,onConfirm:l.func,onCancel:l.func,onShippingAddressChange:l.func,onShippingRateChange:l.func,options:l.object},d.displayName=n,d.__elementType=e,d},p=typeof window>"u",qe=f.createContext(null);qe.displayName="EmbeddedCheckoutProviderContext";m("auBankAccount",p);m("card",p);m("cardNumber",p);m("cardExpiry",p);m("cardCvc",p);m("fpxBank",p);m("iban",p);m("idealBank",p);m("p24Bank",p);m("epsBank",p);m("payment",p);m("expressCheckout",p);m("paymentRequestButton",p);m("linkAuthentication",p);m("address",p);m("shippingAddress",p);m("paymentMethodMessaging",p);m("affirmMessage",p);m("afterpayClearpayMessage",p);var oe="https://js.stripe.com/v3",Le=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,ee="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",Te=function(){for(var e=document.querySelectorAll('script[src^="'.concat(oe,'"]')),t=0;t<e.length;t++){var n=e[t];if(Le.test(n.src))return n}return null},te=function(e){var t=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",n=document.createElement("script");n.src="".concat(oe).concat(t);var o=document.head||document.body;if(!o)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return o.appendChild(n),n},Ie=function(e,t){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"3.3.0",startTime:t})},P=null,U=null,D=null,Ue=function(e){return function(){e(new Error("Failed to load Stripe.js"))}},De=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}},Be=function(e){return P!==null?P:(P=new Promise(function(t,n){if(typeof window>"u"||typeof document>"u"){t(null);return}if(window.Stripe&&e&&console.warn(ee),window.Stripe){t(window.Stripe);return}try{var o=Te();if(o&&e)console.warn(ee);else if(!o)o=te(e);else if(o&&D!==null&&U!==null){var i;o.removeEventListener("load",D),o.removeEventListener("error",U),(i=o.parentNode)===null||i===void 0||i.removeChild(o),o=te(e)}D=De(t,n),U=Ue(n),o.addEventListener("load",D),o.addEventListener("error",U)}catch(d){n(d);return}}),P.catch(function(t){return P=null,Promise.reject(t)}))},Fe=function(e,t,n){if(e===null)return null;var o=e.apply(void 0,t);return Ie(o,n),o},R,se=!1,ie=function(){return R||(R=Be(null).catch(function(e){return R=null,Promise.reject(e)}),R)};Promise.resolve().then(function(){return ie()}).catch(function(r){se||console.warn(r)});var Me=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];se=!0;var o=Date.now();return ie().then(function(i){return Fe(i,t,o)})};Me("pk_test_51P9M6fSG75cgTzAowwJHSac0Eq5fQSPNg11Sb7XGF6qWiLtCjn5MeY705DXbGr2udA1KFEq1iN2aQzy0jzu0Mbsb00ywBojOXI");function _e(){const{handleAddToCart:r,handleRemoveFromCart:e,itemQty:t,cart:n,setCart:o}=pe(),{currentUser:i}=he(),[d,v]=I.useState(!1),[c,g]=I.useState(0),[C,j]=I.useState(0),x=K(X,"Users",i.uid,"Cart"),N=async s=>{v(!0);const u=s.id,A=ye(x,u);await xe(A),v(!1)},O=async()=>{console.log("fetching cart");try{if(i){const s=await be(K(X,"Users",i.uid,"Cart")),u=[];s.forEach(S=>{u.push({id:S.id,...S.data()})}),o(u);const A=n.reduce((S,E)=>S+E.price*E.qty,0),M=n.reduce((S,E)=>S+.1*E.price*E.qty,0);g(A),j(M)}}catch(s){console.log("error fetching cart",s)}};return I.useEffect(()=>{O()},[t,d]),console.log("cli: ",(async()=>fetch("/create-checkout-session",{method:"POST"}).then(s=>s.clientSecret))()),a.jsxs(ve.div,{className:"flex flex-col text-myblack bg-mywhite min-h-screen font-montserrat",initial:{opacity:0,transition:{duration:.3}},animate:{opacity:1},exit:{opacity:0,transition:{duration:.3}},children:[a.jsx("div",{className:"bg-[url('/public/assets/Images/cartBanner.webp')] bg-slate-200 h-20 justify-center items-center flex",children:a.jsx("p",{className:"text-mywhite font-bold text-3xl",children:"Your Cart"})}),a.jsxs("div",{className:"flex flex-grow md:flex-row sm:flex-col-reverse",children:[a.jsx("div",{className:"sm:w-full md:w-5/6 bg-gradient-to-l from-blue-100 via-blue-50 to-blue-50 text-myblack pb-2 max-h-screen  overflow-y-auto overflow-x-hidden",children:n.length===1?a.jsx("div",{className:"flex justify-center items-center",children:a.jsx("p",{className:"text-6xl font-thin text-cyan-900 opacity-80 italic py-20 px-24 tracking-wide leading-normal",children:"In the cart's emptiness, the promise of gaming excitement awaits"})}):a.jsx("div",{children:n.filter(s=>s.qty>0).map(s=>(console.log("Cartttt i am rendering"),a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"text-myblack grid md:grid-cols-2 sm:grid-cols-21 max-h-70 py-7 pl-5 ",children:[a.jsx("div",{className:"flex justify-center items-center",children:a.jsx("img",{src:s.image,alt:s.name,loading:"lazy",className:"md:w-[70%] sm:w-[60%]"})}),a.jsxs("div",{className:"grid grid-rows-2",children:[a.jsx("div",{className:"flex items-center",children:a.jsx("p",{className:"text-lg font-semibold",children:s.name})}),a.jsxs("div",{className:"flex md:flex-row sm:flex-col md:justify-between sm:gap-4 pr-12 ",children:[a.jsx("div",{className:"flex justify-center items-center gap-2 md:flex sm:hidden",children:a.jsx("div",{className:"flex justify-center",children:a.jsxs("div",{className:"grid grid-flow-col w-24 rounded-lg border border-solid border-slate-400  text-slate-800 ",children:[a.jsx("button",{onClick:()=>e(s),className:"px-[2%] py-1 text-slate-800 rounded-s-lg hover:scale-150 ",children:"-"}),a.jsx("p",{className:"text-center py-1",children:s.qty}),a.jsx("button",{onClick:()=>r(s),className:"px-[2%] py-1 text-slate-800 rounded-e-lg hover:scale-150",children:"+"})]})})}),a.jsx("div",{className:"flex md:justify-center sm:justify-start items-center",children:a.jsxs("p",{className:"font-medium",children:["₹ ",s.price]})}),a.jsx("div",{className:"flex justify-center items-center md:flex sm:hidden",children:a.jsx("button",{onClick:()=>N(s),children:a.jsx(Y,{icon:$})})}),a.jsxs("div",{className:"flex justify-between items-center md:hidden sm:flex",children:[a.jsx("div",{className:"flex justify-center items-center gap-2",children:a.jsx("div",{className:"flex justify-center",children:a.jsxs("div",{className:"grid grid-flow-col w-24 rounded-lg border border-solid border-slate-400  text-slate-800 ",children:[a.jsx("button",{onClick:()=>e(s),className:"px-[2%] py-1 text-slate-800 rounded-s-lg hover:scale-150 ",children:"-"}),a.jsx("p",{className:"text-center py-1",children:s.qty}),a.jsx("button",{onClick:()=>r(s),className:"px-[2%] py-1 text-slate-800 rounded-e-lg hover:scale-150",children:"+"})]})})}),a.jsx("div",{className:"flex justify-center items-center",children:a.jsx("button",{onClick:()=>N(s),children:a.jsx(Y,{icon:$})})})]})]})]})]}),a.jsx("div",{className:"absolute left-6 right-6 bottom-0 border-b-[1px] border-gray-500"})]},s.id)))})}),a.jsxs("div",{className:"w-full md:w-2/5 bg-blue-100 sm:p-4 sm:px-10 md:p-10 flex flex-col sm:gap-6 md:gap-10",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("div",{className:" relative flex justify-between font-medium py-5",children:[a.jsx("p",{children:"Subtotal"}),a.jsxs("p",{children:["₹"," ",n.reduce((s,u)=>s+u.price*u.qty,0)]}),a.jsx("div",{className:"absolute left-0 right-0 bottom-0 border-b-[1px] border-gray-500"})]}),a.jsxs("div",{className:"flex relative justify-between font-medium py-5",children:[a.jsx("p",{children:"Discount"}),a.jsxs("p",{children:["₹"," ",n.reduce((s,u)=>s+.1*u.price*u.qty,0)]}),a.jsx("div",{className:"absolute left-0 right-0 bottom-0 border-b-[1px] border-gray-500"})]}),a.jsxs("div",{className:"flex relative justify-between font-medium py-5",children:[a.jsx("p",{children:"Grand Total"}),a.jsxs("p",{children:["₹"," ",n.reduce((s,u)=>s+u.price*u.qty,0)-n.reduce((s,u)=>s+.1*u.price*u.qty,0)]}),a.jsx("div",{className:"absolute left-0 right-0 bottom-0 border-b-[1px] border-gray-500"})]})]}),a.jsx("button",{className:"py-2 mt-8 rounded-md bg-gradient-to-t from-emerald-300 via-emerald-400 to-emerald-500 hover:bg-gradient-to-b transition ease-in-out hover:scale-105 duration-500 hover:shadow-md hover:shadow-green-500/30 font-semibold",children:"Checkout"})]})]})]})}export{_e as default};
